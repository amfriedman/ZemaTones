var esplayer_debug=false;var Array_EsAudioPlayer=new Array();var esp_playing_no=0;var esp_auto_playing=0;var esp_auto_playing_player_num=0;var soundManager_ready=false;var esplayer_jquery_prepared=false;jQuery(document).ready(function(){esplayer_jquery_prepared=true;for(var d=1;d<2048;d++){var e=jQuery("#esplayervar"+d).val();if(typeof e=="undefined"){break}var c=e.split("|");var b=new EsAudioPlayer(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8],c[9],c[10],(c[11].toLowerCase()=="true"),(c[12].toLowerCase()=="true"),c[13],c[14],c[15],c[16])}esplayer_autoplay(d-1)});if(!esplayer_isAdmin){soundManager.url=esAudioPlayer_plugin_URL+"/swf/";soundManager.flashVersion=9;soundManager.useFlashBlock=false;soundManager.useHTML5Audio=true;soundManager.preferFlash=true;soundManager.debugMode=false;soundManager.debugFlash=false;soundManager.allowpolling=true;soundManager.useConsole=true;soundManager.onready(function(){soundManager_ready=true})}function esplayer_autoplay(c){c=typeof(c)!="undefined"?c:0;if(c>0){esp_auto_playing_player_num=c}if(esp_auto_playing<0){return}if(Array_EsAudioPlayer.length<esp_auto_playing_player_num){setTimeout("esplayer_autoplay()",100);return}if(esp_playing_no){setTimeout("esplayer_autoplay()",100);return}for(var b=esp_auto_playing;b<esp_auto_playing_player_num;b++){if(Array_EsAudioPlayer[b].autoplay){esp_auto_playing=b;break}}if(b>=esp_auto_playing_player_num){esp_auto_playing=-1;return}var a=Array_EsAudioPlayer[esp_auto_playing];if((a.created&&a.mode!="slideshow")||(a.created&&a.mode=="slideshow"&&a.tt_obj.ready&&!a.tt_obj.nowtotalplaying)){if(a.mode=="slideshow"){a.tt_obj.loadimage();a.tt_obj.launch_tt(0)}else{a.func_acc_play_stop()}}else{setTimeout("esplayer_autoplay()",100);return}}function esplayer_autoplay_next(){if(esp_auto_playing<0){return}esp_auto_playing++;setTimeout("esplayer_autoplay()",100)}var EsAudioPlayer=function(j,n,f,o,l,d,r,k,g,b,q,s,h,a,m,c,t){this.basecolor_play="";this.symbolcolor_play="";this.basecolor_stop="";this.symbolcolor_stop="";this.basecolor_pause="";this.symbolcolor_pause="";this.color_slider_line="";this.color_slider_knob="";this.n=0;this.sURLs=new Array();this.sURLs[0]=f;this.mySound=new Array();this.mySoundPosition=new Array();this.play=false;this.pause=false;this.created=false;this.preventDrawing=false;this.flgInitializing_beforePlaying=false;this.canvas=0;this.that=this;this.id=n;this.img_id=m;this.width_org=o;this.height_org=l;this.width=o;this.height=l;this.v_pos_org=d;this.v_pos=d;this.canvas_width=o;this.canvas_height=l;this.shw_rate=r;this.shw_color=k;this.corner_rate=(g==-999)?-999:g/100;this.smartphone_rate=(b==-999)?-999:b/100;this.shw_size=0;this.start_anim_retry=0;this.start_time=0;this.anim_ok=false;this.nowPlaying=0;this.border_img=q;this.debug_msg="";this.duration=this.calc_duration(a);this.mode=j;this.loop=s;this.autoplay=h;this.tt_id_list=new Array();this.ready=false;var e=this;var p=function(){e.init()};this.init_id=setInterval(p,100)};EsAudioPlayer.prototype.init=function(){if(!esplayer_jquery_prepared){return}clearInterval(this.init_id);var f=this;this.GetSizeInPx();this.sx_st=this.height+(this.height*0.15);this.sx_en=this.width-(this.height*0.3);this.sy=this.canvas_height/2;this.slider_x=-1;this.slider_y=-1;this.slider_mouse_ofs_x=0;this.slider_mouse_ofs_y=0;this.slider_length=(this.width>=this.height*2)?this.sx_en-this.sx_st:0;this.slider_drag=false;this.slider_width=this.height*0.1;this.slider_height=this.height*0.5;this.slider_img=new Image();if(this.mode=="simple"){this.isIPhone=(new RegExp("(iPhone|iPod|iPad)","i")).test(navigator.userAgent);this.isAndroid=(new RegExp("(Android)","i")).test(navigator.userAgent);this.isSmartphone=("ontouchstart" in window);this.isGecko=navigator.userAgent.match(/SeaMonkey|Firefox/i)&&navigator.userAgent.match(/rv:[56].0/i);this.isIE=(new RegExp("MSIE (3|4|5|6|7|8)","i")).test(navigator.userAgent);jQuery("#"+this.id).bind(this.isSmartphone?"touchstart":"mousedown",function(g){f.onClick(g)})}this.getSetting();if(!this.isIE){if(this.mode=="simple"){var a=function(){f.initCanvas()};this.initCanvas_id=setInterval(a,20)}else{this.anim_ok=true}}else{var e=function(){f.startAnim_IE()};this.int_IE_id=setInterval(e,20)}if(this.mode=="slideshow"){this.tt_id_list=this.sURLs[0].split(",");this.tt_obj=new EsAudioPlayer_tt(this)}else{}if(this.mode=="imgclick"){var d=jQuery("#"+this.img_id);if(jQuery("#"+this.img_id).parent().get(0).tagName.toUpperCase()=="A"){jQuery("#"+this.img_id).parent().contents().unwrap()}jQuery(d).bind(f.isSmartphone?"touchstart":"mousedown",function(g){esp_auto_playing=-1;f.func_play_stop()});jQuery(d).css("cursor","pointer")}var c=function(){f.initSound()};setInterval(c,200);var b=function(){f.anim()};setInterval(b,500);Array_EsAudioPlayer[Array_EsAudioPlayer.length]=this};EsAudioPlayer.prototype.GetSizeInPx=function(){var c=document.createElement("div");c.setAttribute("id","tmpdiv"+this.id);document.getElementsByTagName("body")[0].appendChild(c);var b=jQuery("#tmpdiv"+this.id);var e=jQuery("#"+this.id+"_tmpspan");jQuery(b).css("width",this.width_org);this.width=parseInt(jQuery(b).css("width").replace("px",""));jQuery(b).css("width",this.height_org);this.height=parseInt(jQuery(b).css("width").replace("px",""));var d=this.v_pos_org;var a=d.substr(0,1);if(a!="-"){a=""}if(a=="-"){d=d.substr(1)}jQuery(b).css("width",d);this.v_pos=parseInt(jQuery(b).css("width").replace("px",""));if(a=="-"){this.v_pos=-this.v_pos}jQuery(e).css("top",this.v_pos+"px")};EsAudioPlayer.prototype.calc_duration=function(c){var b=0;var a="";var d=0;if(c==""){return 0}split1=c.split(":");if(split1.length==2){b=parseInt(split1[0])*60*1000;a=split1[1]}else{a=split1[0]}b+=parseFloat(a)*1000;return b};EsAudioPlayer.prototype.startAnim_IE=function(){this.start_anim_retry++;if(this.start_anim_retry>50){var a=document.getElementById(this.id);var b=!!(a.getContext&&a.getContext("2d"));if(b){this.initCanvas();clearInterval(this.int_IE_id);this.anim_ok=true;return}}};EsAudioPlayer.prototype.initCanvas=function(){this.canvas=document.getElementById(this.id);this.canvas_width=Math.ceil(this.width+this.shw_size);this.canvas_height=Math.ceil(this.height+this.shw_size);if(this.slider_length){}if(!(this.canvas!=null)&&esplayer_debug){alert("Canvas could not be prepared. "+this.id+" is null")}if(this.width_org.search(/px/i)==-1||this.height_org.search(/px/i)==-1){this.canvas.setAttribute("width",this.canvas_width);this.canvas.setAttribute("height",this.canvas_height);if(this.isIE){this.canvas.setAttribute("width",this.canvas_width);this.canvas.setAttribute("height",this.canvas_height)}}this.anim_ok=true;clearInterval(this.initCanvas_id)};EsAudioPlayer.prototype.getSetting=function(a){fr=typeof(a)!="undefined"?true:false;if(this.basecolor_play==""||fr){this.basecolor_play=esplayer_basecolor_play}if(this.symbolcolor_play==""||fr){this.symbolcolor_play=esplayer_symbolcolor_play}if(this.basecolor_stop==""||fr){this.basecolor_stop=esplayer_basecolor_stop}if(this.symbolcolor_stop==""||fr){this.symbolcolor_stop=esplayer_symbolcolor_stop}if(this.basecolor_pause==""||fr){this.basecolor_pause=esplayer_basecolor_pause}if(this.symbolcolor_pause==""||fr){this.symbolcolor_pause=esplayer_symbolcolor_pause}if(this.color_slider_line==""||fr){this.color_slider_line=esplayer_color_slider_line}if(this.color_slider_knob==""||fr){this.color_slider_knob=esplayer_color_slider_knob}if(this.shw_rate==-999||fr){this.shw_rate=esplayer_shadowsize}if(this.shw_color==""||fr){this.shw_color=esplayer_shadowcolor}if(this.corner_rate==-999||fr){this.corner_rate=esplayer_cornersize/100}if(this.smartphone_rate==-999||fr){this.smartphone_rate=esplayer_smartphonesize/100}this.shw_size=Math.min(Math.min(this.width,this.height)*this.shw_rate,100);if(fr){this.preventDrawing=false;this.anim()}};EsAudioPlayer.prototype.initSound=function(){if(esplayer_isAdmin){function a(){}a.prototype.setPosition=function(c){this.position=c};a.prototype.play=function(){this.playState=1};a.prototype.stop=function(){this.playState=0};a.prototype.pause=function(){};this.mySound[0]=new a;this.mySound[0].BytesLoaded=1;this.mySound[0].playState=0;this.mySound[0].duration=this.duration;this.mySound[0].durationEstimate=this.duration;this.mySound[0].position=0;this.mySound[0].bytesTotal=1;this.mySoundPosition[0]=0;this.created=true;return}if(!this.created){if(this.mode=="slideshow"&&!esp_tt_data_ready){return}if(soundManager_ready){if(this.mode=="slideshow"){this.nowPlaying=0;var b;for(b=0;b<this.tt_id_list.length;b++){this.sURLs[b]=esp_tt_data[this.tt_id_list[b]].url;if(soundManager.canPlayURL(this.sURLs[b])){this.mySound[b]=soundManager.createSound({id:this.tt_id_list[b],url:this.sURLs[b],autoLoad:false,stream:true,autoPlay:false,volume:100})}this.mySoundPosition[b]=0}this.created=true}else{if(soundManager.canPlayURL(this.sURLs[0])){this.mySound[0]=soundManager.createSound({id:this.id,url:this.sURLs[0],autoLoad:false,stream:true,autoPlay:false,volume:100})}this.mySoundPosition[0]=0;this.created=true}}}};EsAudioPlayer.prototype.onClick=function(g){if(esplayer_isAdmin){return}this.preventDrawing=false;this.ofs=jQuery(this.canvas).offset();var d=this.getEv(g).pageX-this.ofs.left;var c=this.getEv(g).pageY-this.ofs.top;var b=this.width>=this.height*2?this.height:this.width;if(d>=1&&c>=1&&d<b&&c<this.height){esp_auto_playing=-1;this.func_play_stop()}if(this.slider_x>0){var a=this.slider_width;var e=this.slider_height;if(d>this.slider_x-a*4&&d<this.slider_x+a*3.5&&c>this.slider_y-e/2-a*5&&c<this.slider_y+e/2+a*5){this.slider_mouse_ofs_x=d-this.slider_x;this.slider_mouse_ofs_y=c-this.slider_y;this.slider_drag=true;var f=this;jQuery(document).bind(this.isSmartphone?"touchmove":"mousemove",function(h){f.onMouseMove(h)});jQuery(document).bind(this.isSmartphone?"touchend":"mouseup",function(h){f.onMouseUp(h)});return}}if(d>=this.calc_sx(0)-this.slider_width/2&&c>=this.sy-this.slider_height/2&&d<=this.calc_sx(-1)+this.slider_width/2&&c<=this.sy+this.slider_height/2){this.slider_mouse_ofs_x=0;this.mySound.setPosition(this.calc_pos(d))}};EsAudioPlayer.prototype.getEv=function(a){return(this.isSmartphone?window.event.changedTouches[0]:a)};EsAudioPlayer.prototype.onMouseMove=function(a){this.slider_x=this.getEv(a).pageX-this.slider_mouse_ofs_x-this.ofs.left;this.slider_x=Math.max(this.calc_sx(0),this.slider_x);this.slider_x=Math.min(this.calc_sx(this.mySound[this.nowPlaying].duration),this.slider_x);this.preventDrawing=false;this.anim()};EsAudioPlayer.prototype.onMouseUp=function(b){this.mySound[this.nowPlaying].setPosition(this.calc_pos(this.slider_x));var a=this;jQuery(document).unbind("mousemove touchmove mouseup touchend");this.slider_drag=false};EsAudioPlayer.prototype.calc_sx=function(d){if(d<0){return this.sx_en}if(d==0){return this.sx_st}var a=this.mySound[this.nowPlaying];var b=(this.duration>0)?this.duration:a.durationEstimate;var c=(a.bytesLoaded!=a.bytesTotal)?b:a.duration;return this.sx_st+(this.sx_en-this.sx_st)*d/(c)};EsAudioPlayer.prototype.calc_pos=function(d){var a=this.mySound[this.nowPlaying];var b=(this.duration>0)?this.duration:a.durationEstimate;var c=(a.bytesLoaded!=a.bytesTotal)?b:a.duration;return(d-this.sx_st)/(this.sx_en-this.sx_st)*c};EsAudioPlayer.prototype.draw_button_base=function(c,e,b,d,f){var a=this.canvas.getContext("2d");this.ie_shadow(a,c,e,b,d);a.fillStyle=f;this.set_button_shadow(a,true);a.fillRoundedRect(c,e,b-c,d-e,Math.min(b-c,d-e)*this.corner_rate);this.set_button_shadow(a,false)};EsAudioPlayer.prototype.draw_play_button=function(c,f,b,e,d){var a=this.canvas.getContext("2d");a.beginPath();a.moveTo(c+(b-c)*0.3,f+(e-f)*0.25);a.lineTo(c+(b-c)*0.8,f+(e-f)*0.5);a.lineTo(c+(b-c)*0.3,f+(e-f)*0.75);a.closePath();a.fillStyle=d;a.fill()};EsAudioPlayer.prototype.draw_stop_button=function(c,f,b,e,d){var a=this.canvas.getContext("2d");a.fillStyle=d;a.fillRect(c+(b-c)*0.3,f+(e-f)*0.3,(b-c)*0.4,(e-f)*0.4)};EsAudioPlayer.prototype.draw_pause_button=function(c,f,b,e,d){var a=this.canvas.getContext("2d");a.fillStyle=d;a.fillRect(c+(b-c)*0.25,f+(e-f)*0.3,(b-c)*0.2,(e-f)*0.4);a.fillRect(c+(b-c)*0.55,f+(e-f)*0.3,(b-c)*0.2,(e-f)*0.4)};EsAudioPlayer.prototype.set_button_shadow=function(b,a){if(a){b.shadowBlur=this.shw_size*(this.isGecko?0.5:0.7);b.shadowOffsetX=this.shw_size/1.7;b.shadowOffsetY=this.shw_size/1.7*(this.isAndroid?-1:1);b.shadowColor=this.shw_color}else{b.shadowBlur=0;b.shadowOffsetX=0;b.shadowOffsetY=0;b.shadowColor="#000000"}};EsAudioPlayer.prototype.ie_shadow=function(a,d,g,c,f,b,e){if(this.isIE){a.fillStyle=this.shw_color;var e=this.shw_size;a.fillRoundedRect(d+e*0.9,g+e*0.9,(c-d),(f-g),Math.min(c-d,f-g)*this.corner_rate)}};EsAudioPlayer.prototype.anim=function(){if(this.mySound[this.nowPlaying]===undefined){return}if(this.mySound[this.nowPlaying].playState){this.flgInitializing_beforePlaying=false}if(this.play&&!this.mySound[this.nowPlaying].playState&&!this.flgInitializing_beforePlaying&&!esplayer_isAdmin){this.func_stop();if(this.mode!="slideshow"){esplayer_autoplay_next()}}if(!this.anim_ok){return}if(this.preventDrawing){return}if(this.mode=="simple"){var b=this.canvas.getContext("2d");b.clearRect(0,0,this.canvas_width,this.canvas_height);var d=this.width>=this.height*2?this.height:this.width;if(this.play){if(this.pause){this.draw_button_base(0,0,this.width-0,this.height-0,this.basecolor_play);this.draw_play_button(0,0,d-0,this.height-0,this.symbolcolor_play)}else{if(this.slider_length>0){this.draw_button_base(0,0,this.width-0,this.height-0,this.basecolor_pause);this.draw_pause_button(0,0,d-0,this.height-0,this.symbolcolor_pause)}else{this.draw_button_base(0,0,this.width-0,this.height-0,this.basecolor_stop);this.draw_stop_button(0,0,d-0,this.height-0,this.symbolcolor_stop)}}}else{this.draw_button_base(0,0,this.width-0,this.height-0,this.basecolor_play);this.draw_play_button(0,0,d-0,this.height-0,this.symbolcolor_play)}if(this.slider_length>0){var g=this.height*0.5;b.fillStyle=this.color_slider_line;b.fillRect(this.sx_st,g-this.height*0.03/2,this.sx_en-this.sx_st,this.height*0.03);var e=this.mySound[this.nowPlaying];if(!(e.bytesLoaded===undefined||e.bytesLoaded===null)){b.fillStyle=this.color_slider_line;b.fillRect(this.sx_st,g-this.height*0.06/2,(this.sx_en-this.sx_st)*(e.bytesLoaded/e.bytesTotal),this.height*0.06)}var a;if(e.position){a=e.position}else{a=this.mySoundPosition[this.nowPlaying]}var c=0;if(!this.slider_drag){this.slider_y=g;var f=(this.duration>0)?this.duration:e.durationEstimate;var h=(e.bytesLoaded!=e.bytesTotal)?f:e.duration;if(h){this.slider_x=this.sx_st+(this.sx_en-this.sx_st)*(a/h);c=this.slider_x-this.slider_width/2}else{c=this.sx_st-this.slider_width/2}}else{c=this.slider_x-this.slider_width/2}b.fillStyle=this.color_slider_knob;b.fillRect(c-this.slider_width/2,g-this.slider_height/2,this.slider_width,this.slider_height)}}if(!this.created){return}if(!this.play){this.preventDrawing=true}};CanvasRenderingContext2D.prototype.fillRoundedRect=fillRoundedRect;function fillRoundedRect(a,e,b,c,d){this.beginPath();this.moveTo(a+d,e);this.lineTo(a+b-d,e);this.quadraticCurveTo(a+b,e,a+b,e+d);this.lineTo(a+b,e+c-d);this.quadraticCurveTo(a+b,e+c,a+b-d,e+c);this.lineTo(a+d,e+c);this.quadraticCurveTo(a,e+c,a,e+c-d);this.lineTo(a,e+d);this.quadraticCurveTo(a,e,a+d,e);this.fill()}EsAudioPlayer.prototype.func_play_stop=function(){var a="";if(arguments.length){a=arguments[0]}if(!this.created){return}if(!this.play){this.func_stop_all_the_other_players()}if(this.pause){this.pause=false;this.mySound[this.nowPlaying].resume();return}if(!this.play){this.start_time=(new Date()).getTime();this.mySound[this.nowPlaying].play();this.play=true;esp_playing_no++;this.flgInitializing_beforePlaying=true}else{if((this.slider_length>0&&a!="play/stop")||a=="play/pause"){this.mySound[this.nowPlaying].pause();this.pause=true}else{if(a!="play"){this.func_stop()}}}this.anim()};EsAudioPlayer.prototype.func_stop_all_the_other_players=function(){if(esplayer_isAdmin){return}for(i=0;i<Array_EsAudioPlayer.length;i++){if(Array_EsAudioPlayer[i].id!=this.id){if(Array_EsAudioPlayer[i].play){Array_EsAudioPlayer[i].func_stop();if(!!Array_EsAudioPlayer[i].tt_obj){Array_EsAudioPlayer[i].tt_obj.stop_slideshow()}}}}};EsAudioPlayer.prototype.func_acc_play=function(){if(!this.play){this.preventDrawing=false;this.func_play_stop()}};EsAudioPlayer.prototype.func_acc_stop=function(){this.func_stop_all_the_other_players();this.func_stop()};EsAudioPlayer.prototype.func_acc_play_stop=function(){this.preventDrawing=false;this.func_play_stop("play/stop")};EsAudioPlayer.prototype.func_acc_play_pause=function(){this.preventDrawing=false;this.func_play_stop("play/pause")};EsAudioPlayer.prototype.func_acc_seek=function(b,d){var a=this.mySound[this.nowPlaying];var c=(this.duration>0)?this.duration:a.durationEstimate;var f=(a.bytesLoaded!=a.bytesTotal)?c:a.duration;var g=a.position;var e=0;if(d=="pct"){e=g+b*0.01*f}else{if(d=="sec"){e=g+b*1000}}if(e<0){e=0}if(e>f){return}a.setPosition(e);this.preventDrawing=false;this.anim()};EsAudioPlayer.prototype.func_stop=function(){this.mySound[this.nowPlaying].stop();this.mySound[this.nowPlaying].setPosition(0);this.play=false;this.pause=false;if(0){var a=this.mySound[this.nowPlaying].url;var b=this.mySound[this.nowPlaying].sID;this.mySound[this.nowPlaying].destruct();this.mySound[this.nowPlaying]=soundManager.createSound({id:b,url:a,autoLoad:false,stream:true,autoPlay:false,volume:100})}this.anim();esp_playing_no--};EsAudioPlayer.prototype.switch_music_by_ttid=function(a){var b;for(b=0;b<this.tt_id_list.length;b++){if(a==this.tt_id_list[b]){this.nowPlaying=b;return}}};EsAudioPlayer.prototype.getCurrentPosition=function(){var c=(new Date()).getTime();var b=c-this.start_time;var a=this.mySound[this.nowPlaying].position;if(b<a){this.start_time=c-a}if(b>a&&b-a>500&&a<this.mySound[this.nowPlaying].duration){this.start_time=c-a}return c-this.start_time};
